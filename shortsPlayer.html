<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Shorts ìŠ¤íƒ€ì¼ í”Œë ˆì´ì–´</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Roboto í°íŠ¸ ì¶”ê°€ -->
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    <!-- Font Awesome ì•„ì´ì½˜ ì¶”ê°€ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #000;
            margin: 0;
            overflow: hidden;
            font-family: 'Roboto', sans-serif;
            /* Roboto í°íŠ¸ ì ìš© */
        }

        #shorts-container {
            width: 360px;
            height: 640px;
            position: relative;
            overflow: hidden;
            color: white;
            display: flex;
            justify-content: space-between;
            flex-direction: row-reverse;
        }

        video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease-in-out;
        }

        /* í”„ë¡œí•„ ì´ë¯¸ì§€ì™€ ì‚¬ìš©ì ì•„ì´ë”” ìŠ¤íƒ€ì¼ */
        .user-info {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            align-items: center;
            color: white;
            font-size: 16px;
        }

        .user-info img {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin-right: 10px;
        }

        .user-info .username {
            font-weight: 500;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        .video-title {
            position: absolute;
            bottom: 20px;
            left: 20px;
            font-size: 15px;
            /* ì œëª© í¬ê¸° ì¡°ì • */
            font-weight: 500;
            /* ì¤‘ê°„ ë‘ê»˜ë¡œ ì„¤ì • */
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            max-width: 320px;
            line-height: 1.3;
            margin-bottom: 40px;
            /* ì œëª© ê°„ê²© ì¡°ì • */
        }

        /* ì•„ì´ì½˜ ì˜ì—­ ìŠ¤íƒ€ì¼ */
        .controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: white;
            gap: 15px;
            /* ë²„íŠ¼ë“¤ ê°„ì˜ ê°„ê²© */
        }

        .control-icon {
            font-size: 24px;
            margin: 10px 0;
            cursor: pointer;
            transition: transform 0.3s ease;
            text-align: center;
            /* ì•„ì´ì½˜ê³¼ í…ìŠ¤íŠ¸ ì¤‘ì•™ ì •ë ¬ */
        }

        .control-icon:hover {
            transform: scale(1.2);
        }

        /* ê° ë²„íŠ¼ì˜ í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .control-text {
            font-size: 12px;
            margin-top: 5px;
        }

        .hashtags {
            position: absolute;
            bottom: 5px;
            left: 20px;
            font-size: 14px;
            color: #1DA1F2;
            /* íŠ¸ìœ„í„° ìŠ¤íƒ€ì¼ ë¸”ë£¨ */
            cursor: pointer;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 40px;
        }

        .hashtags span {
            text-decoration: underline;
        }

        .liked {
            color: #007bff;
            /* ì¢‹ì•„ìš” í´ë¦­ ì‹œ ìƒ‰ìƒ */
        }

        .disliked {
            color: #dc3545;
            /* ì‹«ì–´ìš” í´ë¦­ ì‹œ ìƒ‰ìƒ */
        }
    </style>
</head>

<body>

    <div id="shorts-container">
        <video id="shorts-video" playsinline autoplay loop muted controls></video>
        <div class="user-info">
            <img id="user-profile-image" src="https://www.w3schools.com/w3images/avatar2.png" alt="User Profile">
            <!-- ì‚¬ìš©ì í”„ë¡œí•„ ì´ë¯¸ì§€ -->
            <div id="username" class="username">ì‚¬ìš©ì ì•„ì´ë””</div> <!-- ì‚¬ìš©ì ì•„ì´ë”” -->
        </div>
        <div id="video-title" class="video-title">ì˜ìƒ ì œëª© 1</div> <!-- ì œëª© ì˜ì—­ -->
        <div id="hashtags" class="hashtags"></div> <!-- í•´ì‹œíƒœê·¸ í‘œì‹œ ì˜ì—­ ì¶”ê°€ -->

        <!-- ë™ì˜ìƒ ì˜¤ë¥¸ìª½ì— ì¢‹ì•„ìš”, ì‹«ì–´ìš”, ê³µìœ í•˜ê¸° ë²„íŠ¼ ì¶”ê°€ -->
        <div class="controls">
            <div class="control-icon" id="like-button">
                <i class="fas fa-thumbs-up"></i> <!-- ì¢‹ì•„ìš” ì•„ì´ì½˜ -->
                <div class="control-text">ì¢‹ì•„ìš”</div>
            </div>
            <div class="control-icon" id="dislike-button">
                <i class="fas fa-thumbs-down"></i> <!-- ì‹«ì–´ìš” ì•„ì´ì½˜ -->
                <div class="control-text">ì‹«ì–´ìš”</div>
            </div>
            <div class="control-icon" id="review-button">
                <i class="fas fa-star"></i> <!-- ë¦¬ë·° ì•„ì´ì½˜ -->
                <div class="control-text">ë¦¬ë·°</div>
            </div>
            <div class="control-icon" id="share-button">
                <i class="fas fa-share-alt"></i> <!-- ê³µìœ í•˜ê¸° ì•„ì´ì½˜ -->
                <div class="control-text">ê³µìœ </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>
    <script>
        // ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œë¥¼ í†µí•œ ì‹¤ì‹œê°„ ì´ë¯¸ì§€ ì†ë„ ì¸¡ì • ë¡œì§
        async function getNetworkSpeed() {
            const fileUrl = "https://upload.wikimedia.org/wikipedia/commons/3/3a/Cat03.jpg"; // ì‘ì€ ìƒ˜í”Œ íŒŒì¼
            const fileSize = 10 * 8; // ì•½ 10KB (80kbps)

            const startTime = performance.now();
            try {
                const response = await fetch(fileUrl, { cache: "no-store" });
                if (!response.ok) throw new Error("ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜");

                await response.blob(); // ì‹¤ì œ ë‹¤ìš´ë¡œë“œ ìˆ˜í–‰
                const endTime = performance.now();

                const speedMbps = fileSize / ((endTime - startTime) / 1000) / 1024; // Mbps ë³€í™˜
                return speedMbps;
            } catch (error) {
                console.warn("âš  ë„¤íŠ¸ì›Œí¬ ì†ë„ ì¸¡ì • ì‹¤íŒ¨, ê¸°ë³¸ê°’ ì ìš© (5Mbps)", error);
                return 5; // ê¸°ë³¸ê°’
            }
        }

        // ì¸¡ì •ëœ ì¸í„°ë„· ì†ë„ì— ë”°ë¼ ë¹„ë””ì˜¤ í€„ëŸ¬í‹° ë¶„ê¸°ì²˜ë¦¬ í•˜ëŠ” ë¡œì§
        async function selectVideoQuality() {
            const speed = await getNetworkSpeed();
            console.log(`ğŸ“¡ í˜„ì¬ ë„¤íŠ¸ì›Œí¬ ì†ë„: ${speed.toFixed(2)} Mbps`);

            let quality;
            if (speed > 10) {
                quality = "1080p";
            } else if (speed > 5) {
                quality = "720p";
            } else {
                quality = "480p";
            }

            console.log(`ğŸ¥ ì„ íƒëœ í’ˆì§ˆ: ${quality}`);
            return quality;
        }


        // ë™ì˜ìƒ ë¦¬ìŠ¤íŠ¸ì™€ ì‚¬ìš©ì ì •ë³´
        const videos = [
            {
                src: "https://prod-usp-logs.s3.ap-northeast-2.amazonaws.com/test_media/video1.mp4",
                title: "í¬ìœ¼ ~ ì´ëŸ° ë‚ ì”¨ì— íšŒì‚¬ ì£¼ì°¨ì¥ì—ì„œ ë‹´ë°°ë¼ë‹ˆ ~",
                username: "dhlee0320",
                profileImage: "https://www.w3schools.com/w3images/avatar2.png",
                hashtags: ["#íšŒì‚¬", "#í¡ì—°", "#ì£¼ì°¨ì¥"],
                liked: false,
                disliked: false
            },
            {
                src: "https://prod-usp-logs.s3.ap-northeast-2.amazonaws.com/test_media/video3.mp4",
                title: "í•˜ëŠ˜ ì¥‘ì´ë…¸!",
                username: "sodamKim3921",
                profileImage: "https://www.w3schools.com/w3images/avatar3.png",
                hashtags: ["#í’ê²½", "#ì—¬í–‰", "#í•˜ëŠ˜"],
                liked: false,
                disliked: false
            },
            {
                src: "https://prod-usp-logs.s3.ap-northeast-2.amazonaws.com/test_media/video4.mp4",
                title: "í ~ GSê±´ì„¤ ì‹œëŸ¬ì‹œëŸ¬",
                username: "soyoung1234",
                profileImage: "https://www.w3schools.com/w3images/avatar4.png",
                hashtags: ["#GSê±´ì„¤", "#íšŒì‚¬ìƒí™œ", "#ì§ì¥ì¸"],
                liked: false,
                disliked: false
            }
        ];

        let currentIndex = 0;
        const videoElement = document.getElementById('shorts-video');
        const titleElement = document.getElementById('video-title');
        const usernameElement = document.getElementById('username');
        const profileImageElement = document.getElementById('user-profile-image');
        const hashtagsElement = document.getElementById('hashtags');

        // ë™ì˜ìƒ ë¯¸ë¦¬ ë¡œë“œ
        function preloadNextVideo() {
            const nextIndex = (currentIndex + 1) % videos.length;
            const nextVideo = document.createElement('video');
            nextVideo.src = videos[nextIndex].src;
            nextVideo.load();
        }

        function playVideo(index) {
            selectVideoQuality();
            videoElement.src = videos[index].src;
            titleElement.textContent = videos[index].title;
            usernameElement.textContent = videos[index].username;
            profileImageElement.src = videos[index].profileImage;
            videoElement.play();

            // í•´ì‹œíƒœê·¸ ì—…ë°ì´íŠ¸
            hashtagsElement.innerHTML = "";
            videos[index].hashtags.forEach(tag => {
                const span = document.createElement('span');
                span.textContent = tag;
                span.onclick = () => onHashtagClick(tag);
                hashtagsElement.appendChild(span);
            });

            // ì¢‹ì•„ìš”/ì‹«ì–´ìš” ìƒíƒœ ì ìš©
            document.getElementById('like-button').classList.toggle('liked', videos[index].liked);
            document.getElementById('dislike-button').classList.toggle('disliked', videos[index].disliked);

            preloadNextVideo();
        }

        function onHashtagClick(tag) {
            alert(`í•´ì‹œíƒœê·¸ í´ë¦­: ${tag}`);
            // ì—¬ê¸°ì— ì›í•˜ëŠ” ë™ì‘ ì¶”ê°€ (ì˜ˆ: ê²€ìƒ‰ ê¸°ëŠ¥ ë“±)
        }

        // ë§ˆìš°ìŠ¤ íœ ë¡œ ë‹¤ìŒ/ì´ì „ ì˜ìƒ ë³€ê²½ (í™”ë©´ ì „ì²´ì—ì„œ ì‘ë™í•˜ë„ë¡)
        document.body.addEventListener('wheel', function (event) {
            if (event.deltaY > 0) {
                if (currentIndex < videos.length - 1) {
                    currentIndex++;
                    playVideo(currentIndex);
                }
            } else {
                if (currentIndex > 0) {
                    currentIndex--;
                    playVideo(currentIndex);
                }
            }
        });

        // ëª¨ë°”ì¼ í„°ì¹˜ ìŠ¤ì™€ì´í”„ ì§€ì›
        let touchStartY = 0;
        document.body.addEventListener('touchstart', (event) => {
            touchStartY = event.touches[0].clientY;
        });

        document.body.addEventListener('touchend', (event) => {
            let touchEndY = event.changedTouches[0].clientY;
            let diff = touchStartY - touchEndY;

            if (diff > 50 && currentIndex < videos.length - 1) {
                // ì•„ë˜ë¡œ ìŠ¤ì™€ì´í”„ (ë‹¤ìŒ ì˜ìƒ)
                currentIndex++;
                playVideo(currentIndex);
            } else if (diff < -50 && currentIndex > 0) {
                // ìœ„ë¡œ ìŠ¤ì™€ì´í”„ (ì´ì „ ì˜ìƒ)
                currentIndex--;
                playVideo(currentIndex);
            }
        });

        // ì¢‹ì•„ìš” ë²„íŠ¼ í´ë¦­ ì‹œ
        document.getElementById('like-button')?.addEventListener('click', function () {
            videos[currentIndex].liked = !videos[currentIndex].liked;  // ì¢‹ì•„ìš” ìƒíƒœ í† ê¸€
            this.classList.toggle('liked', videos[currentIndex].liked);  // ì¢‹ì•„ìš” ìƒíƒœ ì ìš©
            document.getElementById('dislike-button')?.classList.remove('disliked');  // ì‹«ì–´ìš” ìƒ‰ìƒ ì´ˆê¸°í™”
            videos[currentIndex].disliked = false;  // ì‹«ì–´ìš” ìƒíƒœ ì´ˆê¸°í™”
        });

        // ì‹«ì–´ìš” ë²„íŠ¼ í´ë¦­ ì‹œ
        document.getElementById('dislike-button')?.addEventListener('click', function () {
            videos[currentIndex].disliked = !videos[currentIndex].disliked;  // ì‹«ì–´ìš” ìƒíƒœ í† ê¸€
            this.classList.toggle('disliked', videos[currentIndex].disliked);  // ì‹«ì–´ìš” ìƒíƒœ ì ìš©
            document.getElementById('like-button')?.classList.remove('liked');  // ì¢‹ì•„ìš” ìƒ‰ìƒ ì´ˆê¸°í™”
            videos[currentIndex].liked = false;  // ì¢‹ì•„ìš” ìƒíƒœ ì´ˆê¸°í™”
        });

        // ë¦¬ë·° ê¸°ëŠ¥
        document.getElementById('review-button').addEventListener('click', () => {
            alert('ë¦¬ë·° í´ë¦­');
            // ì—¬ê¸°ì— ì‹«ì–´ìš” ì²˜ë¦¬ ë¡œì§ ì¶”ê°€
        });

        // ê³µìœ í•˜ê¸° ê¸°ëŠ¥
        document.getElementById('share-button').addEventListener('click', () => {
            alert('ê³µìœ í•˜ê¸° í´ë¦­');
            // ì—¬ê¸°ì— ê³µìœ í•˜ê¸° ì²˜ë¦¬ ë¡œì§ ì¶”ê°€
        });

        // Plyr.js ì ìš©
        document.addEventListener('DOMContentLoaded', () => {
            new Plyr('#shorts-video', {
                controls: ['play', 'progress', 'current-time', 'mute', 'fullscreen']
            });
            playVideo(0); // ì²« ë²ˆì§¸ ì˜ìƒ ìë™ ì¬ìƒ
        });

        // ğŸš€ ì‹¤í–‰ ì˜ˆì‹œ
        // selectVideoQuality().then(quality => {
        //     videos.forEach(video => {
        //         video.src = video.src.replace("480p", quality); // íŒŒì¼ëª…ì— í’ˆì§ˆ í¬í•¨ ì‹œ ë³€ê²½ ê°€ëŠ¥
        //     });
        //     playVideo(currentIndex);
        // });
    </script>

</body>

</html>